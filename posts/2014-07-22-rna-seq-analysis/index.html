<!doctype html><html><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><title>RNA-Seq基本概念和数据分析流程 - Yulong Niu</title><link rel=icon type=image/png href=icons/favicon.ico><meta name=viewport content="width=device-width,initial-scale=1"><meta property="og:title" content="RNA-Seq基本概念和数据分析流程"><meta property="og:description" content="RNA-Seq分析流程。"><meta property="og:type" content="article"><meta property="og:url" content="https://YulongNiu.github.io/posts/2014-07-22-rna-seq-analysis/"><meta property="article:section" content="posts"><meta property="article:published_time" content="2014-07-22T17:03:15-04:00"><meta property="article:modified_time" content="2014-07-22T17:03:15-04:00"><meta name=twitter:card content="summary"><meta name=twitter:title content="RNA-Seq基本概念和数据分析流程"><meta name=twitter:description content="RNA-Seq分析流程。"><link href="https://fonts.googleapis.com/css?family=Ubuntu:300,400,300italic,400italic|Raleway:200,300" rel=stylesheet><link rel=stylesheet type=text/css media=screen href=https://YulongNiu.github.io/css/bootstrap-table.css><link rel=stylesheet type=text/css media=screen href=https://YulongNiu.github.io/css/normalize.css><link rel=stylesheet type=text/css media=screen href=https://YulongNiu.github.io/css/main.css><link rel=stylesheet type=text/css href=https://YulongNiu.github.io/css/custom.css><link rel=stylesheet type=text/css href=https://YulongNiu.github.io/css/dark.css media="(prefers-color-scheme: dark)"><link rel=stylesheet type=text/css href=https://YulongNiu.github.io/css/custom-dark.css media="(prefers-color-scheme: dark)"><script src=https://cdn.jsdelivr.net/npm/feather-icons/dist/feather.min.js></script>
<script src=https://YulongNiu.github.io/js/main.js></script>
<script src=https://YulongNiu.github.io/js/abc.js></script>
<script src=https://YulongNiu.github.io/js/xyz.js></script></head><body><div class="container wrapper post"><div class=header><base href=https://YulongNiu.github.io/><h1 class=site-title><a href=https://YulongNiu.github.io/>Yulong Niu</a></h1><div class=site-description><h2>个人博客</h2><nav class="nav social"><ul class=flat><a href=https://github.com/YulongNiu title=Github><i data-feather=github></i></a><a href=https://twitter.com/YulongNiu title=Twitter><i data-feather=twitter></i></a></ul></nav></div><nav class=nav><ul class=flat><li><a href=/>Home</a></li><li><a href=/posts>Posts</a></li><li><a href=/tags>Tags</a></li><li><a href=/about>About</a></li></ul></nav></div><div class=post-header><h1 class=title>RNA-Seq基本概念和数据分析流程</h1><div class=meta>Posted at &mdash; Jul 22, 2014</div></div><div class=markdown><p>RNA-Seq相比较基因芯片，价格虽然昂贵一些，精度和灵敏度更高。同时，在测序深度足够时，也可以检测mRNA选择性剪切类型。</p><h2 id=1-样品制备>1. 样品制备</h2><h2 id=2-测序>2. 测序</h2><p>Illumina双端测序<a href=http://www.illumina.com/technology/next-generation-sequencing/paired-end-sequencing_assay.html>动画</a>和<a href=http://onetipperday.blogspot.sg/2013/12/illumina-hiseq2000-adapter-and.html>图示</a>。</p><h2 id=3-分析流程>3. 分析流程</h2><p>RNA-Seq<a href=http://blog.qiuworld.com:8080/archives/2343>主要分析流程</a>：</p><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>原始数据质量评估 --&gt;
</span></span><span style=display:flex><span>数据清洗（去除接头和低质量read） --&gt;
</span></span><span style=display:flex><span>清洗数据质量评估 --&gt;
</span></span><span style=display:flex><span>map测序结果至基因组（转录组） --&gt;
</span></span><span style=display:flex><span>map数据质量评估 --&gt;
</span></span><span style=display:flex><span>差异表达基因/选择性剪切/新基因/融合基因选择 --&gt;
</span></span><span style=display:flex><span>GO和pathway分析 --&gt;
</span></span><span style=display:flex><span>共表达网络分析
</span></span></code></pre></div><h3 id=31-序列清洗>3.1 序列清洗</h3><p>序列清洗主要是去除测序结果中的<a href=http://onetipperday.blogspot.sg/2013/06/illumina-hiseq2000-adapter.html>adapter</a>或通用引物等。</p><p>以下使用Illumina HiSeq2000平台，对一个人类样本的RNA测序。统计各种序列清洗方法和选择后的reads数目。原始数据两端测序reads分别为54,492,228和54,492,228。</p><table class="table table-responsive table-striped"><thead><tr><th>Method</th><th>#Trimmed</th><th>#Mapped*</th><th>#Filtered</th></tr></thead><tbody><tr><td>r50-notrim</td><td>108,984,456</td><td>109,278,388</td><td>79,143,942</td></tr><tr><td>r50-nomixed-notrim</td><td>108,984,456</td><td>103,548,800</td><td>79,143,942</td></tr><tr><td>r50-nomixed-trimmomatic-min20</td><td>104,164,622</td><td>116,315,394</td><td>80,337,256</td></tr><tr><td>r50-nomixed-trimmomatic-min36</td><td>101,548,172</td><td>110,778,108</td><td>79,248,896</td></tr><tr><td>r50-nomixed-trimmomatic-min50</td><td>98,525,312</td><td>106,659,988</td><td>77,779,424</td></tr><tr><td>r50-nomixed-galore-min20</td><td>107,097,862</td><td>114,943,386</td><td>83,039,928</td></tr><tr><td>r100-nomixed-galore-min20</td><td>107,097,862</td><td>114,944,672</td><td>87,899,316</td></tr><tr><td>r165sd45-nomixed-galore-min20</td><td>107,097,862</td><td>114,201,366</td><td>90,750,208</td></tr><tr><td>r165sd45G-nomixed-galore-min20</td><td>107,097,862</td><td>109,901,742</td><td>93,477,122</td></tr><tr><td>r165sd45-nomixed-galore-min50</td><td>104,869,208</td><td>109,258,544</td><td>89,329,672</td></tr></tbody></table><p><strong>*</strong>：使用TopHat2把序列mapped到hs19基因组。TopHat2默认设置为，如果一个reads能mapped到多个位点，则都会报道。因此数目可能比原始数据多。<h2 id=4-分析过程注意事项>4. 分析过程注意事项</h2><ol><li>参考转录组注释文件（GFF/GTF）的染色体编号，与基因组信息一致。比如都用<code>chr1</code>，或者都用<code>1</code>标识1号染色体。可能出现问题地方：</li></ol><ul><li><p><a href=http://ccb.jhu.edu/software/tophat/manual.shtml>TopHat</a>的<code>-G/--GTF</code>参数。</p></li><li><p><a href=http://miso.readthedocs.org/en/fastmiso/#human-mouse-gene-models-for-isoform-centric-analyses>MISO</a>程序<code>pe_utils</code>的传入转录组注释文件。</p></li></ul><h2 id=5-基本概念>5. 基本概念</h2><ul><li><p><strong>Read</strong>：是组成测序的结果的基本单位。</p></li><li><p><strong>Count</strong>：在某次测序中，对于某个指标（比如某个基因），得到的reads数的总和。</p></li><li><p><strong>RPKM</strong>（Reads Per Kilobase per Million）和<strong>FPKM</strong>（Fragments Per Kilobase per Million）：</p><ul><li><p>首先需要解释FPKM和RPKM的原理是相似的，区别在于FPKM对应的是DNA片段，比如在一个Illumina的pair-end（双尾）RNA-Seq中，一对（两个）reads对应是一个DNA片段。有了FPKM（RPKM）概念，我们就能比较：同一个样本中基因A和基因B的相对表达量；或者不同样本中，同一个基因的相对表达量。</p></li><li><p>具体的原因是：引入“每一千碱基（per kilobase）”的原因在于，不同的RNA可能有不同长度，长度越长，对应的reads就越多。当每个RNA都除以自身长度（以1000碱基为单位）时，就可以比较同一个样本中不同基因的相对表达量了。相似地，引入“每一百万reads”的原因是，不同的样本可能测序的深度不一样，深度越深，当然对应的reads就越多了。如果结果除以各自库的数量（以一百万reads为单位），那么我们就能很好地衡量两个不同样本中同一个基因的相对表达量。</p></li></ul></li><li><p><strong>Alignment</strong>：确定测得的reads在基因组上的位置的过程。</p></li><li><p><strong>Mapping</strong>：确定aligned reads对应的转录本。</p></li><li><p><strong>Pair end (PE)<strong>和</strong>Mate-Pair (MP)</strong>：</p><ul><li><p>两种双端测序的方法，主要区别在样品库制备和测序上。比如PE制备的库是adapter在目标序列两端，而MP库中adapter在目标序列中间。因此，在数据分析时，MP类型测序必须注意剔除adapter。具体参考<a href="http://seqanswers.com/forums/showthread.php?t=503">论坛讨论</a>和<a href=http://scottmyourstone.blogspot.sg/2013/11/difference-between-paired-end-and-mate.html>Difference Between Paired-End and Mate-Pair Reads</a>。</p></li><li><p>在序列软件软件中，有时也称呼一对测序reads（对同一个目标片段分别测得的正义链和反义链），它们互为mate，分别存在两个对应的测序结果文件中。</p></li></ul></li><li><p><strong>Adapter（接头）</strong>、<strong>Barcode（标签）<strong>和</strong>Insert（插入片段）</strong>：</p><ul><li><p>adapter是一段短的序列已知的核酸链，用于链接序列未知的目标测序片段。</p></li><li><p>barcode，也称为index，是一段很短的寡居核酸链，用于在多个样品混合测序时，标记不同的样品。</p></li><li><p>insert是用于测序的目标片段，因为是包括在两个adapter之间，所以被称为“插入”片段。</p></li><li><p>一个常见测序片段类似与<code>adapter--barcode--insert--adapter</code>。测序开始时前几个碱基无法测得，第一个adapter在数据输出时被去除；由于测序仪读长限制，第二个adapter通常无法测得。所以，经常得到类似 <code>barcode--部分insert</code>的read。最后，把barcode去除，只保留测度insert的片段，这个操作的术语是demultiplexing。</p></li><li><p>需要注意的是，<a href=http://www.illumina.com/documents/products/datasheets/datasheet_truseq_sample_prep_kits.pdf>Illumina TruSeq</a>样品库制备方法中，barcode是在adapter中部，而且是与insert分开测序。而<a href=https://support.illumina.com/content/dam/illumina-support/documents/documentation/chemistry_documentation/samplepreps_nextera/nexteramatepair/nextera-mate-pair-reference-guide-15035209-02.pdf>Illumina Nextera Mate Pair</a>样品库制备中，adapter在目标序列中部。</p></li></ul></li><li><p><strong>Concordant Pairs</strong>和<strong>Discordant Pairs</strong>：根据<a href=http://bowtie-bio.sourceforge.net/bowtie2/manual.shtml#paired-inputs>Bowtie2</a>的解释，concordant pairs表示一对reads在alignment时，既方向匹配又有合适距离（Bowtie2中是200bp～500bp）。如果上述方向和距离，任意一个条件不满足，则称为discordant pairs。</p></li><li><p><strong>chrN_random</strong>和<strong>chrUn</strong>：基因组文件中通常含有类似<code>chr9_gl000198_random</code>和<code>chrUn_gl000211</code>的基因组。根据<a href=https://genome.ucsc.edu/FAQ/FAQdownloads.html#download11>UCSC</a>解释，<code>chrN_random</code>包括基因组已知但具体位置未知序列，或者位置已知但具体内容未完成序列。<code>ChrUn</code>中包括一些具体位置未知的序列。</p></li><li><p><strong>chrN_xxx_hap1</strong>：转录组注释文件中会出现类似<code>chr6_apd_hap1</code>和<code>chr6_dbb_hap3</code>的基因组注释。根据<a href="http://genome.ucsc.edu/cgi-bin/hgGateway?org=Human&amp;db=hg19">UCSC解释</a>这些基因组是<a href=http://hapmap.ncbi.nlm.nih.gov/originhaplotype.html.en>单倍型(haplotype)基因组</a>。</p></li></ul><h3 id=参考网址>参考网址</h3><ul><li><p>推荐幻灯片<a href="http://www.slideshare.net/mikaelhuss/all-bio-rnaseqqc?from_action=save">RNA-Seq quality control and pre-processing</a></p></li><li><p><a href=https://www.bioconductor.org/help/workflows/rnaseqGene/>Bioconductor详细流程</a></p></li><li><p>RPKM和FPKM：<a href=http://jefworks.com/rpkm-and-fpkm-explained/>1</a>、 <a href=http://www.cureffi.org/2013/09/12/counts-vs-fpkms-in-rna-seq/>2</a>和<a href=http://www.partek.com/Tutorials/microarray/User_Guides/UnderstandingReads.pdf>3一个计算RPKM的例子</a></p></li><li><p>ENCODE推荐的RNA-Seq数据分析指导 <a href=http://genome.ucsc.edu/ENCODE/protocols/dataStandards/ENCODE_RNAseq_Standards_V1.0.pdf>The ENCODE Consortium: Standards, Guidelines and Best Practices for RNA-Seq</a></p></li><li><p>RNA-Seq差异表达分析工作流程：<a href=http://216.49.144.90:8080/archives/3007/comment-page-2>中文</a>，<a href=http://vallandingham.me/RNA_seq_differential_expression.html>英文</a></p></li><li><p><a href=http://www.rna-seqblog.com/how-many-reads-are-enough/>多少个read才够</a></p></li><li><p><a href=http://bowtie-bio.sourceforge.net/bowtie2/manual.shtml#paired-inputs>Bowtie2对一些常用名词解释</a></p></li><li><p><a href=http://www.plob.org/2014/11/09/8672.html>二代测序中barcodes index的介绍</a></p></li><li><p>Illumina样品制备参考：<a href=https://www.med.unc.edu/pharm/calabreselab/files/tufts-sequencing-primer>Illumina TruSeq DNA Adapters De-Mystified</a>和<a href=http://bioinformatics.cvr.ac.uk/blog/illumina-adapter-and-primer-sequences/>Illumina adapter and primer sequences</a></p></li><li><p><a href=http://cgrlucb.wikispaces.com/file/view/readMapping.pdf>Best Practices and Suggestions for Read Alignment</a></p></li><li><p><a href=http://barcwiki.wi.mit.edu/wiki/SOPs/rna-seq-diff-expressions>Using RNA-Seq to quantify gene levels and assay for differential expression</a></p></li></ul><h3 id=更新记录>更新记录</h3><p>2017年9月16日</p></div><div class=post-tags><nav class="nav tags"><ul class=flat><li><a href=/tags/bioinfo>bioinfo</a></li></ul></nav></div></div><div class="footer wrapper"><nav class=nav><div>© Copyright notice | <a href=https://github.com/vividvilla/ezhil>Ezhil theme</a> | Built with <a href=https://gohugo.io>Hugo</a></div></nav></div><script type=application/javascript>var doNotTrack=!1;doNotTrack||(window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,ga("create","UA-53073828-1","auto"),ga("send","pageview"))</script><script async src=https://www.google-analytics.com/analytics.js></script>
<script>feather.replace()</script></body></html>